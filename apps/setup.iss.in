; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

; **** NOTE ****
;
; Update AppVerName and OutputBaseFilename when changing versions!

[Setup]
AppName=TrustedQSL
AppVerName=TrustedQSL @VERSION@
OutputBaseFilename=tqsl-@WINVER@
AppPublisher=ARRL
AppPublisherURL=http://www.arrl.org/lotw/
AppSupportURL=http://www.arrl.org/lotw/
AppUpdatesURL=http://www.arrl.org/lotw/
DefaultDirName={pf}\TrustedQSL
DefaultGroupName=TrustedQSL
OutputDir=.

[Tasks]
Name: "desktopicon"; Description: "Create a &desktop icon"; GroupDescription: "Additional icons:"

[InstallDelete]
Type: files; Name: "{app}\libexpat.dll"
Type: files; Name: "{app}\tqsllib.dll"
Type: files; Name: "{app}\licenses\LICENSE"
Type: files; Name: "{userappdata}\TrustedQSL\config.xml"

[Files]
Source: "@WINWD@\tqsl.exe"; DestDir: "{app}"; Flags: ignoreversion
Source: "@WINWD@\tqslcert.exe"; DestDir: "{app}"; Flags: ignoreversion
Source: "@WINWD@\help\tqslapp\*.*"; DestDir: "{app}\help\tqslapp"; Flags: ignoreversion
Source: "@WINWD@\help\tqslcert\*.*"; DestDir: "{app}\help\tqslcert"; Flags: ignoreversion
Source: "@WINTQSLDIR@\bin\tqsllib2.dll"; DestDir: "{app}"; Flags: ignoreversion
Source: "@WINWD@\quick.txt"; DestDir: "{app}"; Flags: ignoreversion
Source: "@WINTQSLDIR@\share\tqsl\config.xml"; DestDir: "{app}"; Flags: ignoreversion
Source: "@WINWD@\LICENSE.txt"; DestDir: "{app}\licenses"; Flags: ignoreversion
Source: "@WINWD@\ChangeLog.txt"; DestDir: "{app}"; Flags: ignoreversion
; NOTE: Don't use "Flags: ignoreversion" on any shared system files

[Icons]
Name: "{group}\TQSL"; Filename: "{app}\tqsl.exe"
Name: "{group}\TQSLCert"; Filename: "{app}\tqslcert.exe"
Name: "{group}\Quick Start"; Filename: "{app}\quick.txt"
Name: "{userdesktop}\TQSL"; Filename: "{app}\tqsl.exe"; Tasks: desktopicon
Name: "{userdesktop}\TQSLCert"; Filename: "{app}\tqslcert.exe"; Tasks: desktopicon

[Run]
Filename: "{app}\quick.txt"; Description: "Read Quick Start"; Flags: shellexec postinstall skipifsilent
Filename: "{app}\ChangeLog.txt"; Description: "Read What's New"; Flags: shellexec postinstall skipifsilent unchecked

[Registry]
Root: HKCR; Subkey: ".tq6"; ValueType: string; ValueName: ""; ValueData: "tqslcert"; Flags: uninsdeletevalue
Root: HKCR; Subkey: "tqslcert"; ValueType: string; ValueName: ""; ValueData: "TQSLCert file"; Flags: uninsdeletekey
Root: HKCR; Subkey: "tqslcert\DefaultIcon"; ValueType: string; ValueName: ""; ValueData: "{app}\TQSLCERT.EXE,0"
Root: HKCR; Subkey: "tqslcert\shell\open\command"; ValueType: string; ValueName: ""; ValueData: """{app}\TQSLCERT.EXE"" ""%1"""
Root: HKLM; Subkey: "Software\TrustedQSL\TQSLCert"; ValueType: string; ValueName: "InstallPath"; ValueData: "{app}"
Root: HKLM; Subkey: "Software\TrustedQSL"; ValueType: string; ValueName: "HelpDir"; ValueData: "{app}\help"
Root: HKLM; Subkey: "Software\TrustedQSL"; ValueType: string; ValueName: "InstallPath"; ValueData: "{app}"

